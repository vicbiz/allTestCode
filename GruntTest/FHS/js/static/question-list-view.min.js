$().ready(function(){if($(window).bind("beforeunload",function(){if(0<$(".editViewFrame:visible input.save").length&&"disabled"!==$(".editViewFrame:visible input.save").attr("disabled"))return"You have not saved the content you entered on this page."}),0<$("#appEvaluator, #appInternal-App").length){setTimeout(function(){!function(){if(0<$("#appEvaluator .qaBlock.notAnswered, #appInternal-App .qaBlock.notAnswered").length){var e=$(".qaBlock.notAnswered:first");$("html, body").animate({scrollTop:e.offset().top-80},100),$(".onlyNotAnsweredItem").show()}else $(".onlyNotAnsweredItem").hide()}()},100);var e=function(){$(".qaBlock.questionHeaderBlock").each(function(){0<$(this).find(".btnYesNo-No").length?$(this).addClass("noAnswered"):$(this).removeClass("noAnswered"),0<$(this).find(".btnYesNo-Yes").length?$(this).addClass("YesAnswered"):$(this).removeClass("YesAnswered"),0<$(this).find("a.viewComment.commentViewLink").length?$(this).addClass("hasComment"):$(this).removeClass("hasComment"),0<$(this).find(".myFlag").length?$(this).addClass("hasMyFlag"):$(this).removeClass("hasMyFlag")});var e=[],a=".qaBlock",n=!1;$("#showAll").prop("checked")&&(n=!0),$("#onlyNotAnswered").prop("checked")&&(e.push("notAnswered"),n=!0),$("#NoAnswers").prop("checked")&&(e.push("noAnswered"),n=!0),$("#YesAnswers").prop("checked")&&(e.push("YesAnswered"),n=!0),$("#withComments").prop("checked")&&(e.push("hasComment"),n=!0),$("#myFlags").prop("checked")&&(e.push("hasMyFlag"),n=!0),e.map(function(e,n,t){a+="."+e}),""==a&&(n=!1),n?($(".qaBlock").hide(),$(a).show()):$(".qaBlock").show(),$("#toTop").trigger("click")};$("#onlyNotAnswered, #NoAnswers, #YesAnswers, #withComments, #myFlags, #showAll").on("change",function(){e()}),e(),$(window).scroll(function(){270<$(window).scrollTop()?$("#onlyNotAnsweredInnerWrap").addClass("fixedPositionFilterBar"):$("#onlyNotAnsweredInnerWrap").removeClass("fixedPositionFilterBar")}),$("#toTop").on("click",function(e){e.preventDefault();var n=0*$(document).scrollTop();$("html,body").animate({scrollTop:n},"slow",function(){})}),$("#toBottom").on("click",function(e){e.preventDefault();var n=100*$(document).innerHeight()/100;$(document).height(),$(window).height();$("html, body").animate({scrollTop:n},900)})}$("#evaluationCMS.internalApp .editAnswer a, #evaluationCMS.evaluator .editAnswer a").on("click",function(e){e.preventDefault();var n=$(this),u=n.parentsUntil(".evalNotes").parent().find(".editViewFrame"),t=n.attr("href"),r=n.attr("data-eId"),v=(n.attr("data-qId"),n.parentsUntil(".questionHeaderBlock").parent());n.parentsUntil(".questionHeaderBlock").find(".editAnswer");if(0<$(".editViewFrame:visible").length&&!$(".editViewFrame:visible input.save").attr("disabled")){if(0==confirm("You have not saved the content you entered on this page."))return!1;for(name in CKEDITOR.instances)CKEDITOR.instances[name]&&CKEDITOR.instances[name].destroy(!0),$(".editViewFrame").each(function(){$(this).html("")})}for(name in CKEDITOR.instances)CKEDITOR.instances[name]&&CKEDITOR.instances[name].destroy(!0);$(".editViewFrame").each(function(){$(this).html("")}),$(".editViewFrame:visible").not(u).hide("fast").html(""),n.parentsUntil(".evalNotes").parent().find(".commentViewFrame").hide(),u.html(""),u.load(t,function(){var i=u.find("textarea").attr("id");0<u.find(".fhsSelect").length&&$(".fhsSelect").selectpicker({style:"btn-wt form-control",menuStyle:"dropdown-inverse"}),i&&(CKEDITOR.replace(i,{toolbar:[{name:"basicstyles",groups:["basicstyles","cleanup"],items:["Italic"]},{name:"Redactor",items:["Redactor"]}]}),0===$("#notes").length&&CKEDITOR.on("instanceReady",function(e){var n=e.editor;if(void 0!==n){n.focus();var t=n.document.getBody(),a=n.createRange();a&&(a.moveToElementEditablePosition(t,!1),a.select()),n.document.on("click",function(){n.focus()})}})),sectionAnswerJS(),u.slideToggle("fast",function(){var e=95;$("#onlyNotAnsweredInnerWrap").hasClass("fixedPositionFilterBar")&&(e=55),$("html, body").animate({scrollTop:v.offset().top-e},100)}),$('[data-toggle="radio"]').each(function(){$(this).radio()});var t=u.find("input.save"),a=u.find("input.cancel"),e=u.find("input"),n=u.find("textarea"),s=u.find("form");for(var m in $(t).attr("disabled","disabled"),$(a).attr("disabled","disabled"),$(s).change(function(){$(s).data("changed",!0),$(t).removeAttr("disabled"),$(a).removeAttr("disabled")}),$(e).change(function(){$(s).data("changed",!0),$(t).removeAttr("disabled"),$(a).removeAttr("disabled")}),$("body").on("click",".qAnswerChoice .yesNoBlock .answerSelect, .answerSelectNA .radio, .answerSelect .radio, .qAnswerChoice .answerSelect, .qAnswerChoice li, .qAnswerChoice .postStaySelect label.radio, .qAnswerChoice span input",function(){$(s).data("changed",!0),$(t).removeAttr("disabled"),$(a).removeAttr("disabled")}),$(n).keyup(function(){var e=$(s).parentsUntil(".qaBlock").parent(),n=e.find(".multiAnswerText[data-qtype='OPEN_TEXT']").length;0<e.find(".openTextOnlyNA").length&&(n=1),0<n&&(s.find("#noAnswer").val("0"),s.find("#noAnswer").removeAttr("checked"),s.find(".answerRadioBtns .answerSelect label.radio").removeClass("checked"),s.find(".answerSelect.bgClassNA").removeClass("bgClassNA")),$(s).data("changed",!0),$(t).removeAttr("disabled"),$(a).removeAttr("disabled")}),CKEDITOR.instances){function o(){CKEDITOR.instances[m].updateElement(),$("textarea").trigger("keyup")}CKEDITOR.instances[m].on("instanceReady",function(){this.document.on("keyup",o),this.document.on("paste",o),$(".cke_toolbar").on("click",function(){o()})})}$(t).on("click",function(e){e.preventDefault();var n=$(this),h=$(n).closest("form"),t="";for(var a in CKEDITOR.instances)CKEDITOR.instances[a].updateElement();$.each($("#editAnswerFormBlock form select"),function(e,n){var t=$(this).val();$(this).find('option[value="'+t+'"]').prop("selected",!0)}),0==$(h).find("#noAnswer").val()?t=$(h).serialize()+"&noAnswer="+$(h).find("#noAnswer").val():(h.find("#numericAnswer").val("0"),t=$(h).serialize());var s=h.find("input:radio"),o=!1;if(0<h.find(".yesNoBlock").length?$.each(s,function(){$(this).prop("checked")&&(o=!0)}):o=!0,o){$("body").addClass("noScroll"),$("body").prepend("<div id='pageLoadingOverlay'><div id='ajaxDataLoading'><span>Saving Data .....</span></div></div>"),setInterval(function(){$("#ajaxDataLoading span").fadeOut(500).fadeIn(500)},400),$.ajax({type:"POST",url:"/evaluationResponse/ajaxUpdate?evaluationId="+r+"&questionId="+i,data:t,success:function(e,n,t,a){var s=$(h).parentsUntil(".qaBlock").parent(),o=$(s).find(".evalNoteText"),i="";if(0===$(s).find(".multiAnswerBlock").length){var r=$(s).find(".answerYN"),l=$(s).find(".questionNumber");1==e.noAnswer?i="N/A":1==e.numericAnswer?i="Yes":2==e.numericAnswer&&(i="No");$(s).find(".questionNumber");$(r).removeClass("btnYesNo-Yes").removeClass("btnYesNo-No").removeClass("btnYesNo-NA").addClass("btnYesNo-"+i),$(l).removeClass("evalYesNo-Yes").removeClass("evalYesNo-No").removeClass("evalYesNo-NA").addClass("evalYesNo-"+i),$(r).html(i),""===i?$(r).removeClass("hidden").addClass("hidden"):$(r).removeClass("hidden")}else{var d=$(s).find(".multiAnswerText"),c=$(d).attr("data-qtype"),f=$(d).html(),p="";1==e.noAnswer&&(i="N/A"),"N/A"===i?(f="",p='<div class="btnYesNo-N/A btn btn-Rectangle fs1x">N/A</div>'):("ELAPSED_TIME"===c&&(f=$(h).find("#hours").val()+" : "+$(h).find("#minutes").val()+" : "+$(h).find("#seconds").val()+" (H:M:S)"),"MULTIPLE_CHOICE"===c&&(f=$(h).find("select#multipleChoice option:selected").text()),"CURRENCY_AMOUNT"===c&&(f=$(h).find(".currencyAmount option:selected").val()+" : "+$(h).find(".currencyAmountNumber").val()),"OPEN_TEXT"===c&&0<$("#appInternal-App").length&&(f=$(h).find(".notesCkEditor textarea").val()),"EMOTIONAL_ENGAGEMENT"===c&&(f=$(h).find("#emotionalEngagement option:selected").text()),"POST_STAY"===c&&(f=$(h).find(".postStaySelect .radio.checked").text())),$(d).html(f),$(h).parentsUntil(".qaBlock").parent().find(".yesNoNADiv").html(p)}$(o).html(e.notes),u.slideToggle("fast");for(m in $(".evalNotes").each(function(){var e=$(this),n=$(e).find(".evalNoteText").html();void 0!==n&&(""===n.trim()?($(e).parent().find(".evalNoteTitle").hide(),$(e).parent().find(".evalNoteText").hide()):($(e).parent().find(".evalNoteTitle").show(),$(e).parent().find(".evalNoteText").show(),$(e).parent().find(".evalNoteText").expander("destroy").expander({slicePoint:540,expandText:"&nbsp;&nbsp;&nbsp; MORE",expandPrefix:"… ",userCollapseText:"&nbsp;&nbsp;&nbsp; LESS",userCollapsePrefix:" "})))}),$("#ajaxDataLoading, #pageLoadingOverlay").remove(),$("body").removeClass("noScroll"),$(".editViewFrame:visible input.save").attr("disabled","disabled"),CKEDITOR.instances)CKEDITOR.instances[m]&&CKEDITOR.instances[m].destroy();u.html(""),v.removeClass("notAnswered"),$("html, body").animate({scrollTop:v.offset().top},100)},error:function(e,n,t){alert("data submission error, please try again")}})}else alert("You must select Yes, No or N/A to proceed.")});a=u.find("input.cancel");$(a).on("click",function(e){if(e.preventDefault(),$(s).data("changed")){if(!1===confirm("You have not saved the content you entered on this page."))return!0;for(m in CKEDITOR.instances)CKEDITOR.instances[m].destroy(!0)}u.html("").css("display","none")})})}),$("#setNAall").on("click",function(e){return fhsAlert("myModal","Warning","<p>Setting “N/A to all” will overwrite any answers you have entered, and cannot be undone. Are you sure you want to set N/A to all questions in this section?</p>","CANCEL","YES",function(e){if(1!=e)return!1;$("#naToAllform").submit()}),!1})});