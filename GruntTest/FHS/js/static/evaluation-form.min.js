$().ready(function(){var e="#startDate, #endDate, #dueDate, #evaluatorDueDate";$(e).datepicker({showOtherMonths:!0,selectOtherMonths:!0,dateFormat:"mm-dd-yy",yearRange:"-1:+1"}).prev(".btn").on("click",function(t){t&&t.preventDefault(),$(e).focus()}),$("body").on("click",".input-group-btn button.calIcon",function(){$(this).parent().parent().find("input.hasDatepicker").focus()}),$(e).datepicker("widget").css({"margin-left":-$(e).prev(".btn").outerWidth()});var a=function(t){var e=t,a=$(e).find("input").attr("value"),n=$(e).find("input").attr("data-name"),r=$(this).text().trim(),i=$("#evaluationForm").attr("data-assetType"),o=$("#competitive");"FTG Ratings"===n?o.removeClass("hidden"):($("#brandAnalysis").removeAttr("checked"),$("#brandAnalysis").prop("checked",!1),$("#brandAnalysis").val(""),$("#compSetNumber").val("0"),$("#cpNumberSelect button#compSetNumber .filter-option").text($("#cpNumberSelect ul.dropdown-menu li:first-child").text()),$("#cpNumberSelect ul.dropdown-menu li").removeClass("selected"),$("#cpNumberSelect ul.dropdown-menu li:first-child").addClass("selected"),s(),o.addClass("hidden")),$(".pickListBlock").prepend("<div id='pickListDataLoading'><span>Loading Data .....</span></div>"),setInterval(function(){$("#pickListDataLoading span").fadeOut(500).fadeIn(500)},400),$.ajax({type:"GET",url:"/evaluation/listSectionsForEvaluationType?id="+a+"&assetTypeId="+i,dataType:"html",success:function(t,e){$("#selectedEvalTitle").text(r),$("#sections").html(t),$("#sections").pickList("destroy"),$("#sections").pickList({sourceListLabel:"Available Sections",targetListLabel:"Selected Sections *",addAllClass:"btn-dark",addClass:"btn-dark",removeAllClass:"btn-dark",removeClass:"btn-dark",afterAddAll:function(){$(".pickList_list.pickList_sourceList").hide().fadeIn("fast")},afterRemoveAll:function(){$(".pickList_list.pickList_targetList").hide().fadeIn("fast")},afterBuild:function(){}}),$("#pickListDataLoading").remove()},error:function(t,e,a){}})};$("#standardYear").change(function(){!function(){pageLoading();var t=$("#standardYear"),e=$(t).attr("data-assetId"),a=$(t).find("option:selected").val();$.ajax({type:"GET",url:"/evaluation/listEvaluationTypesForAssembly?assetId="+e+"&standardYearId="+a,dataType:"json",success:function(e,t){var a="";0<e.length&&($.each(e,function(t){a+='<label class="radio col-sm-4"><label class="radio"><input type="radio" id="optionsRadios{'+t+'}" data-toggle="radio" value="'+e[t].id+'" name="evaluationType.id" data-name="'+e[t].name+'"></label>'+e[t].name+"</label>"}),$("#selectEvalType").html(a),$('[data-toggle="radio"]').each(function(){$(this).radio()})),$("#pageLoadingOverlay").remove(),$("body").removeClass("noScroll")},error:function(t,e,a){}})}(),a()});var n=!0;0<$(".newEvalForm").length&&(n=!1),$("body").on("click","#selectEvalType .radio",function(t){if($(this).hasClass("disabled"))return!1;var e=$(this);if(n){if(0<$(".editEvalForm").length){t.stopImmediatePropagation(),fhsAlert("myModal","Are you sure?","Are you sure you want to change Evaluation Type?","No","Yes",function(t){if(!1===t)return!1;n=!1,$(e).trigger("click"),a($(this))})}}else a($(this))});var r=!0,t=$("#standardYear").parent().find(".dropdown-menu li a");if($(t).on("click",function(t){var e=$(this);if(!0===r&&0<$(".editEvalForm").length){t.stopImmediatePropagation(),fhsAlert("myModal","Are you sure?","Changing the Standards Year will re-set your selected Evaluation Types and Sections below. \n Are you sure you want to change the year?","No","Yes",function(t){if(!1===t)return!1;n=r=!1,$(e).trigger("click")})}}),$("#topRightActionMenuDropDownCancel").on("click",function(t){t.preventDefault();$(this);var e='Please provide a short explanation of why you are canceling this evaluation. (i.e. "blown evaluation," "merged with another evaluation," etc.) Maximum Character Limit : 3500<br/><br/><form id="cancelEval" method="post" action="'+$("#topRightActionMenuDropDownCancel").attr("href")+'"><textarea maxlength="3500" id="cancelNotes" class="form-control" rows="5" cols="140" placeholder="" name="cancelNotes"/></form>';t.stopImmediatePropagation(),fhsAlert("myModal","Cancel Evaluation",e,"Exit without Canceling","Cancel Evaluation",function(t){if(!1===t)return!1;$("#cancelEval").submit()})}),""==$("#selectedEvalTitle").text()){var i=$("#selectEvalType .checked").text().trim();$("#selectedEvalTitle").text(i)}$("#sections").pickList({sourceListLabel:"Available Sections",targetListLabel:"Selected Sections *",addAllClass:"btn-dark",addClass:"btn-dark",removeAllClass:"btn-dark",removeClass:"btn-dark",afterBuild:function(){$(".disabled .pickList_controlsContainer button").attr("disabled","disabled"),$("body").on("click",".disabled .pickList_list li",function(t){return t.preventDefault(),!1}),$(".disabled .pickList_list li").on("dblclick",".disabled .pickList_list li",function(t){return t.preventDefault(),!1})}}),0<$(".multiSelectError").length&&$(".multiSelectError").each(function(){$(this).find(".pickList_targetList").addClass("error")}),$("#startDate").on("change",function(){var t=$.datepicker.parseDate("mm-dd-yy",$("#startDate").val()),e=$.datepicker.parseDate("mm-dd-yy",$("#endDate").val());null!==t&&null!==e&&e<t?($("#startDate").addClass("error"),$("#startDate").parent().find("button").addClass("error"),alert("Visit End Date has to be after Visit Start Date.")):($("#startDate").removeClass("error"),$("#startDate").parent().find("button").removeClass("error"))}),$("#endDate").on("change",function(){var t=$.datepicker.parseDate("mm-dd-yy",$("#startDate").val()),e=$.datepicker.parseDate("mm-dd-yy",$("#endDate").val());if(null===e||""===e)return!0;e<t||null===t?($("#startDate").addClass("error"),$("#startDate").parent().find("button").addClass("error")):($("#startDate").removeClass("error"),$("#startDate").parent().find("button").removeClass("error"))}),$("form#theForm").on("submit",function(t){var e=$.datepicker.parseDate("mm-dd-yy",$("#startDate").val()),a=$.datepicker.parseDate("mm-dd-yy",$("#endDate").val()),n=$("#compSetNumber").val(),r=$("#compSetReviewer").val();if(""==r&&0<parseInt(n))return $("#compSetReviewerSelector").addClass("error"),alert("You must select an Assigned Reviewer when competitive sets are present!"),""!=r;if(null!==a&&null===e)return $("#startDate").addClass("error"),$("#startDate").parent().find("button").addClass("error"),alert("Visit Start Date is required to save Visit End Date"),$("#startDate").focus(),!1;if(null!==e&&null!==a&&a<e)return $("#startDate").addClass("error"),$("#startDate").parent().find("button").addClass("error"),alert("Visit End Date has to be after Visit Start Date."),$("#startDate").focus(),!1;var i=!1;return $(".AssignableUserType").each(function(){$(this).val()!==$($(this).attr("data-ref")).attr("data-label")&&($(this).addClass("error"),i=!0)}),!0!==i});var o=function(){$("#evaluationForm #submitButtons input#create").removeAttr("disabled"),$("#evaluationForm #submitButtons input#cancel").val("cancel")};$("#evaluationForm #submitButtons input#create").attr("disabled","disabled"),$("body").on("change","#evaluationForm input, #evaluationForm textarea, #evaluationForm select",function(){o()}),$("body").on("dblclick",".pickList_listContainer",function(){o()}),$("body").on("click",".pickList_controlsContainer:not(.disabled .pickList_controlsContainer)",function(){o()}),$("body").on("keyup","textarea#notes",function(){o()}),$("body").on("click","#evaluationForm #cancel",function(t){if(t.preventDefault(),"disabled"!==$("#evaluationForm #submitButtons input#create").attr("disabled")){if(1!=confirm("You have not saved the content you entered on this page."))return!1;window.location="/"}else window.location="/"}),$("#viewAssetNotesLink").click(function(t){t.preventDefault();var e="Asset Notes";""!==$(".excelLinkContent").attr("data-title")&&void 0!==$(".excelLinkContent").attr("data-title")&&(e=$(".excelLinkContent").attr("data-title"));var a=$($(this).attr("data-helpContent")).html();a=$.nl2br(a,!0);t.stopImmediatePropagation(),fhsAlert("myModal",e,a,"","CLOSE",function(t){})});var s=function(){var t=$("#compSetRequired");0<(""!=$("#compSetNumber").val()?parseInt($("#compSetNumber").val()):0)?t.removeClass("hidden"):($("#compSetReviewerSelector").val(""),$("#compSetReviewer").val(""),t.addClass("hidden"))};$("#compSetNumber").on("change",function(){s()}),s(),""===$("#compSetReviewerSelector").val()&&$("#compSetReviewer").val("")});