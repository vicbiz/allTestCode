$().ready(function(){$("#submitEvaluationApprovedNotPublished").on("click",function(e){e.preventDefault();$(this);var t=$("#submitEvaluationApprovedNotPublished").attr("href");e.stopImmediatePropagation(),fhsAlert("myModal","Are you sure?","Are you sure you want to approve this evaluation report?","Exit without approving","Approve Evaluation Report",function(e){if(!1===e)return!1;window.location.href=t})}),$("#submitEvaluationApprovedPublished").on("click",function(e){e.preventDefault();$(this);var t=$("#submitEvaluationApprovedPublished").attr("href");e.stopImmediatePropagation(),fhsAlert("myModal","Are you sure?","Are you sure you want to publish this evaluation report?","Exit without publishing","Publish Evaluation Report",function(e){if(!1===e)return!1;window.location.href=t})}),$("#hideHeaderTop").click(function(){$("#headerBlock").slideToggle("slow",function(){$("#headerBlock").is(":visible")?($.cookies.set("headerTop","shown"),$("#hideHeaderTop").text("-"),$("#headerBlock").removeClass("hidden")):($("#headerBlock").removeClass("hidden"),$.cookies.set("headerTop","hidden"),$("#hideHeaderTop").text("+"))})}),void 0!==$.cookies.get("headerTop")&&null!==$.cookies.get("headerTop")&&""!==$.cookies.get("headerTop")||($.cookies.set("headerTop","shown"),$.cookies.setOptions({expiresAt:null})),$(".evalNoteText").expander({slicePoint:540,expandText:"&nbsp;&nbsp;&nbsp; MORE",expandPrefix:"â€¦ ",userCollapseText:"&nbsp;&nbsp;&nbsp; LESS",userCollapsePrefix:" "}),$("#evalTotalProgressBar, #evalTotalProgressTxt").on("click",function(){$("#evalTotalProgressBar").toggle(),$("#evalTotalProgressTxt").toggle()});var c=function(e,t){$("#leftIconMenuBlock .iconMenu").removeClass("active"),e.addClass("active"),$("#leftFlyOutMenu .flyOutMenu").hide(),$(t).show()};0==$("#leftIconMenuBlock .iconMenu.active").length&&$("#leftIconMenuBlock .iconMenu:first-child").addClass("active"),0<window.location.pathname.indexOf("showPhotoUploader")&&($("#leftIconMenuBlock .iconMenu").removeClass("active"),$("#leftIconMenuBlock #menu-2").addClass("active")),0<window.location.pathname.indexOf("showAttachmentUploader")&&($("#leftIconMenuBlock .iconMenu").removeClass("active"),$("#leftIconMenuBlock #menu-4").addClass("active"));var r=function(){$("#mainContentArea").removeClass("col-md-8").addClass("col-md-11"),$("#mainContentArea").removeClass("col-sm-7").addClass("col-sm-11"),$(".commentViewFrame").removeClass("sizeN")},d=function(){var e=$("#leftFlyOutMenu").attr("data-currentSectionId");$(".sectionListMenu [data-sectionId='"+e+"']").addClass("currentSection")};$("body").on("click","#leftIconMenuBlock .iconMenu",function(e){e.preventDefault();var t=$(this),n=t.attr("id")+"-1",a=$("#"+n),o=$(t).hasClass("active"),i=$("#leftFlyOutMenu").attr("data-evaluationId"),s=($("#leftFlyOutMenu").attr("data-currentSectionId"),t.attr("data-original"));if("menu-2-1"==n){var l="";s&&(l="?originalEvaluation=true"),$.ajax({type:"GET",url:"/sectionList/photo/"+i+l,success:function(e){$("#leftFlyOutMenu #menu-2-1").html(e),0<$(".uploaderFormBlock.photo").length&&d()}})}if("menu-3-1"==n){l="";s&&(l="&originalEvaluation=true"),$.ajax({type:"GET",url:"/evaluationComment/getSectionCommentHeader?evaluationId="+i+l,success:function(e){$("#leftFlyOutMenu #menu-3-1").html(e),0<window.location.pathname.indexOf("showSectionComments")&&d()}})}if("menu-4-1"==n){l="";s&&(l="?originalEvaluation=true"),$.ajax({type:"GET",url:"/sectionList/attachment/"+i+l,success:function(e){$("#leftFlyOutMenu #menu-4-1").html(e),0<$(".uploaderFormBlock.attachment").length&&d()}})}$("#leftFlyOutMenu").is(":hidden")?($("#leftFlyOutMenu").show("slow",function(){c(t,a),$("#flyOutCloseBtn").show()}),$("#mainContentArea").removeClass("col-md-11").addClass("col-md-8"),$("#mainContentArea").removeClass("col-sm-11").addClass("col-sm-7"),$(".commentViewFrame").addClass("sizeN")):o?($("#leftFlyOutMenu .flyOutMenu").hide(),""===$("#leftFlyOutMenu").next().html()&&$("#leftFlyOutMenu").next().hide(),$("#leftFlyOutMenu").hide("slow",function(){r()})):c(t,a)}),$("#flyOutCloseBtn").click(function(e){e.preventDefault(),$("#leftFlyOutMenu .flyOutMenu, #flyOutCloseBtn").hide(),$("#leftFlyOutMenu").hide("slow",function(){r()})}),$("#leftIconMenuBlock .iconMenuInfo").click(function(e){e.preventDefault();var t=$("#leftFlyOutMenu #menu-5-1").html();e.stopImmediatePropagation(),fhsAlert("myModal","Info",t,"","CLOSE",function(e){})});var e=$.urlParam("popPanel");if(e?$("#leftIconMenuBlock div[data-panel='"+e+"']").trigger("click"):0<$("#mainContentArea.qaListView").length?$("#leftIconMenuBlock div[data-panel='section']").trigger("click"):0<$("#evaluatorInstructionsContent").length&&"0.0"==$("#evaluatorInstructionsContent").attr("data-sectionprogess")&&$("#leftIconMenuBlock div[data-panel='section']").trigger("click"),$(".questionHelpIcon").on("click",function(){var e=$(this).parentsUntil(".questionHeaderBlock").parent().find(".questionHelpText");$(e).slideToggle("fast")}),0<$("#flashShowMessage .evaluationCompleted").length){fhsAlert("myModal","Evaluation Completed","You have completed the evaluation! <br/>Select a section to review or click the Submit button to send your evaluation to the editor.","","CLOSE",function(e){})}$(".evalNotes").each(function(){var e=$(this).find(".evalNoteText").html();void 0!==e&&(""===e.trim()?($(this).parent().find(".evalNoteTitle").hide(),$(this).parent().find(".evalNoteText").hide()):($(this).parent().find(".evalNoteTitle").show(),$(this).parent().find(".evalNoteText").show()))});var u=function(o,i,s,l,c,r){var e="";0<$(".originalEvaluation").length&&(e="&originalEvaluation=true"),$.ajax({type:"GET",url:"/evaluationComment/listByQuestion?questionId="+s+"&evaluationId="+l+e+"&isCommentingDisabled="+c,dataType:"html",success:function(e,t){$(".commentTextField").val(""),$(o).find(".commentList").html(e);var n="",a=$(o).find(".commentList .row").length;0<a?($($(o).parent().find(".viewComment a")).html("VIEW COMMENTS ("+a+")").removeClass("addComment").addClass("viewComment"),n=(n=$(o).parent().find(".commentIcon img").attr("src")).replace("icon-add-commnet.png","icon-view-commnet.png")):($($(o).parent().find(".viewComment a")).html("ADD COMMENT").removeClass("viewComment").addClass("addComment"),n=(n=$(o).parent().find(".commentIcon img").attr("src")).replace("icon-view-commnet.png","icon-add-commnet.png")),$(o).parent().find(".commentIcon img").attr("src",n),$(".commentText.editable").editable("/evaluationComment/update?questionId="+s+"&evaluationId="+l,{indicator:"Saving...",tooltip:"Click to edit...",data:function(e){return e=e.replace(/<br\s*[\/]?>/gi,"\n"),$.trim(e)},type:"autogrow",submit:"OK",cancel:"Cancel",tooltip:"Click to edit...",onblur:"ignore",name:"text",onsubmit:function(e,t){$(".commentViewFrame .commentList .row .commentText").html("")},callback:function(e,t){$(".commentViewFrame .commentList .row .commentText").html(""),u(o,i,s,l,c,"submit")},autogrow:{lineHeight:36,minHeight:32}}),$(".commentText").on("click",function(){var e=$(this);0===$(e).find(".cmtDelete").length&&($(e).find("form").append('<button type="delete" class="cmtDelete">Delete</button>'),$(e).find("form button").addClass("btn btn-default"))}),$(".commentText").each(function(){var e=$(this).html().replace(/\n/g,"<br/>");e=e.replace(/<br\s*[\/]?>/,""),$(this).html(e)}),"none"!=$(o).css("display")&&"commentTextField"!=r||$(o).slideToggle("fast")},error:function(e,t,n){}})};$("body").on("click",".cmtDelete",function(e){e.preventDefault();var t=$(this).parentsUntil(".commentText").parent().attr("id"),n=$(this).parentsUntil(".evalNotes").parent().find(".commentViewLink"),a=$(this).parentsUntil(".evalNotes").parent().find(".commentViewFrame"),o=$(n).attr("qId"),i=$(n).attr("eId"),s=$(n).attr("cDisabled"),l=$("body").attr("id").replace("app","");return e.stopImmediatePropagation(),fhsAlert("confirm","Delete Comment","Are you sure you want to delete this comment?","No","Yes",function(e){if(!1===e)return!1;$.ajax({type:"POST",url:"/evaluationComment/delete?questionId="+o+"&evaluationId="+i+"&id="+t,success:function(e){u(a,l,o,i,s,"submit")}})}),!1}),$(".commentViewLink").click(function(e){e.preventDefault();var t=$(this),n=t.parentsUntil(".evalNotes").parent().find(".commentViewFrame"),a=$(t).attr("qId"),o=$(t).attr("eId"),i=$(t).attr("cDisabled"),s=$("body").attr("id").replace("app","");$(t).parentsUntil(".evalNotes").parent().find(".editViewFrame").hide(),$(t).hasClass("addComment")&&$(".commentTextField").val(""),$(t).hasClass("viewComment")&&($(".commentTextField").val(""),u(n,s,a,o,i,"viewLink")),$(".commentViewFrame").not(n).slideUp(),$(n).slideToggle("fast",function(){$("#leftFlyOutMenu").is(":visible")&&$(".commentViewFrame").is(":visible")&&$(".commentViewFrame").addClass("sizeN"),$(n).find(".commentTextField").focus()})}),$(".commentViewFrame .commentAdd .submitcommentBtn").click(function(e){e.preventDefault();var t=$(this),n=$(t).parentsUntil(".evalNotes").parent().find(".commentViewFrame"),a=$(t).attr("qId"),o=$(t).attr("eId"),i=$(t).attr("cDisabled"),s=$("body").attr("id").replace("app",""),l=$(this).closest("form"),c=$(l).find(".commentTextField");if(""==$(c).val())return $(c).addClass("error"),!1;$.ajax({type:"POST",url:"/evaluationComment/save",data:l.serialize(),success:function(e){u(n,s,a,o,i,"submit")}})}),0<$("#notes").length&&CKEDITOR.on("instanceReady",function(e){var t=e.editor;if(void 0!==t){t.focus();var n=t.document.getBody(),a=t.createRange();a&&(a.moveToElementEditablePosition(n,!1),a.select()),t.document.on("click",function(){t.focus()})}}),$("body").on("click",".makeCommentRead",function(){var t=$(this),e=($("body").attr("id").replace("app",""),$(t).attr("qId")),n=$(t).attr("eId");$.ajax({type:"POST",url:"/evaluationComment/markAllAsRead?questionId="+e+"&evaluationId="+n,success:function(e){$(t).hide(),$(t).parentsUntil(".evalNotes").parent().find(".commentIconNew").hide()}})}),$("body").on("change","#feViewCommentCheckBox",function(){$("body").attr("id").replace("app","");var e=$(this).attr("data-eId");$.ajax({type:"POST",url:"/evaluationComment/toggleEvaluatorAccessToCommentsReport?evaluationId="+e+"&canEvaluatorAccessCommentsReport="+$(this).prop("checked"),success:function(e){}})})});var sectionAnswerJS=function(){if(0<$(".qAnswerChoice .elapsedTime").length&&($(".qAnswerChoice .elapsedTime input").each(function(){var e=parseInt($(this).val());if(""===e&&(e=0),e<10){var t="0"+e;$(this).val(t)}}),$(".qAnswerChoice .elapsedTime input").on("click",function(){$(this).select()}),$(".qAnswerChoice .elapsedTime input").on("blur",function(e){var t=$(this),n=parseFloat($(this).val()),a=59;if(""===n&&(n=0),$(this).hasClass("elapsedTimeHour")&&(a=23),0<=n&&n<=a){if(10*n%10!=0)alert("Invalid time format"),$(t).addClass("error"),setTimeout(function(){$(t).focus().select()},50);else if(n<10){var o="0"+parseInt($(this).val());$(this).val(o)}}else alert("Invalid time"),$(t).addClass("error"),setTimeout(function(){$(t).focus().select()},50)})),0<$("select.currencyAmount").length&&($(".currencyAmountBlock input.currencyAmountNumber").on("click",function(){$(this).select()}),$(".currencyAmountBlock input.currencyAmountNumber").on("blur",function(e){var t=$(this),n=$(this).val();parseFloat(n);/^\d+$/.test(n)||/^((\d+(\.\d *)?)|((\d*\.)?\d+))$/.test(n)||(alert("Invalid Currency Format."),$(t).addClass("error"),setTimeout(function(){$(t).focus().select()},50))})),0<$("#qFormBlock .qAnswerChoice .yesNoBlock").length){var e=$("#qFormBlock .qAnswerChoice .yesNoBlock label.radio.checked input"),t=parseInt(e.attr("value")),n=(e.attr("id"),e.parentsUntil(".answerSelect").parent()),a=$("#qFormBlock .qAnswerChoice .yesNoBlock label.radio.checked input#noAnswer");$("#qFormBlock .qAnswerChoice .yesNoBlock .answerSelect").removeClass("bgClassYes bgClassNo bgClassNA"),0<a.length?(a.parentsUntil(".answerSelect").parent().addClass("bgClassNA"),$("#qFormBlock .qAnswerChoice .yesNoBlock .radio.checked").removeClass("checked"),a.parent().addClass("checked")):(1===t&&n.addClass("bgClassYes"),2===t&&n.addClass("bgClassNo"),n.parent().addClass("checked"))}$("body").on("click",".qAnswerChoice .answerSelect, .qAnswerChoice .answerSelect, .qAnswerChoice li, .qAnswerChoice .postStaySelect label.radio, .qAnswerChoice span input",function(){$(this).closest("form").data("changed",!0),$(".saveNextBtnGroup input.save, .saveNextBtnGroup input.cancel").removeAttr("disabled");var e=$(this),t=0;if(($(e).hasClass("bgClassYes")||$(e).hasClass("bgClassNo"))&&(t=1),0===t){$.each($(".qAnswerChoice .answerSelect"),function(e,t){$(this)[0].className=$(this)[0].className.replace(/\bbgClass.*?\b/g,"")}),$(".qAnswerChoice .answerSelect .radio.checked").removeClass("checked");$(e).find("input").val();var n=$.trim($(e).find(".answerValue").html()),a=$(e).closest("form").find("input#noAnswer"),o=$(e).closest("form").find("#numericAnswer");if("N/A"===n){n="NA",$(a).val("1").attr("checked","checked"),$(a).closest("form").find(".postStaySelect .radio.checked").removeClass("checked");var i=$(a).closest("form").parentsUntil(".qaBlock").parent().find(".multiAnswerText[data-qtype='OPEN_TEXT']").length;if(0<e.find(".openTextOnlyNA").length&&(i=1),0<i)for(var s in CKEDITOR.instances)CKEDITOR.instances[s],CKEDITOR.instances[s].name,CKEDITOR.instances[s].value,CKEDITOR.instances[s].setData(""),CKEDITOR.instances[s].updateElement(),CKEDITOR.instances[s].on("key",function(){$(a).closest("form").find(".bgClassNA .radio.checked").removeClass("checked"),$(a).closest("form").find(".bgClassNA").removeClass("bgClassNA"),$(a).closest("form").find("#noAnswer").val("0"),$(a).closest("form").find("#noAnswer").removeAttr("checked"),CKEDITOR.instances[s].updateElement()})}else"Yes"===n&&o.val("1"),$(a).parentsUntil(".answerSelectNA.bgClassNA").removeClass("bgClassNA"),$(a).val("0").removeAttr("checked"),$(".editViewFrame").find("#noAnswer").val("0").removeAttr("checked");$(e).addClass("bgClass"+n),$(e).find("input:radio").prop("checked",!0),$(e).find("label.radio").addClass("checked")}}),$("#showUnansweredQuestions").on("click",function(n){n.preventDefault();var e=$(this).attr("data-evalId");$.ajax({type:"GET",url:"/evaluationCMS/showUnanswered/"+e,success:function(e){var t=e;n.stopImmediatePropagation(),fhsAlert("myModal","Unanswered Questions",t,"","CLOSE",function(e){})}})})};