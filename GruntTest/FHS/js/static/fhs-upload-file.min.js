$().ready(function(){var c=function(){0<$(".uploaderFormBlock.photo").length?""!==$(".uploaderFormBlock form .customfile-list-block").html()&&""!==$(".uploaderFormBlock form select option:selected").val()?$(".uploaderFormBlock form #Submit").removeAttr("disabled"):$(".uploaderFormBlock form #Submit").removeAttr("disabled").attr("disabled","disabled"):""!==$(".uploaderFormBlock form .customfile-list-block").html()?$(".uploaderFormBlock form #Submit").removeAttr("disabled"):$(".uploaderFormBlock form #Submit").removeAttr("disabled").attr("disabled","disabled")},a=void 0!==$("<input/>")[0].multiple,i=/msie/i.test(navigator.userAgent);$.fn.customFile=function(){return this.each(function(){var n=$(this).addClass("customfile"),t=$('<div class="customfile-wrap"><div class="customfile-list-block"></div>'),s=$('<input type="text" class="customfile-filename" style="display: none;" />'),e=$('<button type="button" class="btn browseBtn">BROWSE</button>'),o=$('<label class="customfile-upload" for="'+n[0].id+'">BROWSE</label>');n.css({position:"absolute",left:"-9999px"}),t.insertAfter(n).append(n,s,i?o:e),n.attr("tabIndex",-1),e.attr("tabIndex",-1),e.click(function(){n.focus().click()}),n.change(function(){var t,e,o,i=[];if(a){for(var l=0,r=(t=n[0].files).length;l<r;l++)i.push(t[l].name);e=i.join(", "),o=i.join("<br/>")}else o=e=n.val().split("\\").pop();s.val(e).attr("title",e).focus(),$(".customfile-list-block").html(o),c()}),s.on({blur:function(){n.trigger("blur")},keydown:function(t){if(13===t.which)i||n.trigger("click");else{if(8!==t.which&&46!==t.which)return 9===t.which&&void 0;n.replaceWith(n=n.clone(!0)),n.trigger("change"),s.val("")}}})})},a||$(document).on("change","input.customfile",function(){var t=$(this),e="customfile_"+(new Date).getTime(),o=t.parent(),i=o.siblings().find(".customfile-filename").filter(function(){return!this.value}),l=$('<input type="file" id="'+e+'" name="'+t.attr("name")+'"/>');setTimeout(function(){t.val()?i.length||(o.after(l),l.customFile()):(i.parent().remove(),o.appendTo(o.parent()),o.find("input").focus())},1)}),$("input[type=file]").customFile(),$(".uploaderFormBlock form select").on("change",function(){c()}),$(".uploaderFormBlock form").on("submit",function(){if(""===$(this).closest("form").find("#description").val())return $(this).closest("form").find("#description").focus().addClass("error"),!1}),$(".uploaderFormBlock form input#description").keyup(function(){$(this).removeClass("error")})});